<!-- Spiel an sich -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link href="static/style.css" rel="stylesheet">
  <title>Atmiņas spēle</title>
</head>
<body>
  <div class="wrapper">
    <div class="header">
      <h1>Atmiņas spēle</h1>
      <ul>
        <li>
          <a href="/">Sākums</a>
        </li>
        <li>
          <a href="game">Spēle</a>
        </li>
        <li>
          <a href="top">Tops</a>
        </li>
        <li>
          <a href="about">Par</a>
        </li>
      </ul>
    </div> <!-- Beidzas header -->

    <h1>Minēšanas spēle</h1>

    <!-- Anzeigen des Spielers und des Levels -->
    <p>Spēlētājs: <span id="playerName"></span></p>
    <p>Izvēlētais līmenis: <span id="playerLevel"></span></p>

    <!-- Rateing -->
    <input type="number" id="guessInput" placeholder="Ievadi skaitli" disabled>
    <button onclick="makeGuess()" disabled>Minēt</button>
    <p id="message"></p>

  </div> <!-- Beidzas wrapper -->

  <script>
    // Spielername und Level aus der Session abrufen
    window.onload = function() {
      let playerName = sessionStorage.getItem('playerName');
      let playerLevel = sessionStorage.getItem('playerLevel');

      // Anzeigen des Namens und Levels
      document.getElementById("playerName").textContent = playerName;
      document.getElementById("playerLevel").textContent = playerLevel;

      // Hier Spiel starten (z.B. Level setzen)
      startGame(playerLevel);
    }

    function startGame(level) {
      // Spiel mit dem ausgewählten Level starten
      fetch('/start_game', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ level: parseInt(level) })
      })
      .then(response => response.json())
      .then(data => {
        alert(data.message);
        // Rateing-Feld aktivieren, wenn das Spiel beginnt
        document.getElementById("guessInput").disabled = false;
        document.querySelector("button[onclick='makeGuess()']").disabled = false;
      });
    }

    // Rateversuch
    function makeGuess() {
      let guess = document.getElementById("guessInput").value;

      if (guess === '') {
        alert("Lūdzu, ievadiet skaitli!");
        return;
      }

      fetch('/guess', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ guess: parseInt(guess) })
      })
      .then(response => response.json())
      .then(data => document.getElementById("message").innerText = data.message);
    }
  </script>

  <script src="static/game.js"></script>
</body>
</html>